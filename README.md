# REAL Library Relational Database Design with Web-based UI
- In this project, we designed a RESTful library database system catering to diverse users(regular customers, authors and system administrators) with website interface. Provided rental services, room reservations and events management.
- Utilized Oracle Data Modeler and MySQL for database design, and implemented the website using PHP, Html and JavaScript (Materilize CSS).

### Table of Contents
- [Database Model](#db-model-)
- [Security Features](#secure-feature-)
- [Web-based UI](#web-)
- [Usage](#usage)

## Database Model a name="db-model-"></a>
### 1. E-R Model
![image](/pictures/E_R_model.png)

### 2. Relational Model
![image](/pictures/relational_model.png)

### 3. Assumptions
- The copy should be returned at earliest one day after. The borrow date of a new rental must be after the return date of the former rental for the same copy.
- The rental records and corresponding invoices will be retained, linked to the relational copy, after returning the copy.
The ID of a rental and an invoice will be generated by the rule that it uses the date of the start borrowing + copies ID and the date of returning + copies ID respectively.
- Each new rental behavior will generate a rental ID. The customer should return the book with the rental ID.
- A study room has a capacity of 5 people at most.
- A study room can only be reserved by one customer for the same date and time slot. One customer can reserve not one study room for the same date and time slot.

## Security Features <a name="secure-feature-"></a>
### Encrypted Password
For protecting the security of the users’ passwords, the relational data will be encrypted before inserting into the database. The popular DES-ECB algorithm embedded in PHP openssl_encrpy is applied into our design.

### Input Sanitization
User inputs are sanitized and formatted using regex statements(preg_match). We also use PHP’s htmlspecialchars and mysqli_real_escape_string functions to ensure that users won’t suffer from SQL injection attacks.

### Exception Handler
For the best and smooth performance to the system, we set expectation handlers to prevent any warnings and errors that may fail a task.

### Transaction and anti-deadlock
In order to maintain the consistency and integrity of database records, various measures have been implemented to ensure the smooth execution and accurate recording of business activities. Specifically, the system incorporates transaction design to address unique scenarios, such as handling a surge in customers seeking to rent the last available copy within a short timeframe.

For a customer to successfully rent a book, two essential relational operations must be executed without errors: modifying the copy's status and generating a unique rental ID. The process involves checking the availability status of the copy, with a record lock implemented to prevent immediate modifications by others during the check. If the copy is available ('Y'), the customer can proceed to modify the availability to 'N' and continue the transaction; otherwise, the transaction is interrupted.

In the event of any failure during the subsequent operations, the entire transaction is rolled back, undoing all previous actions. Conversely, if all steps are completed successfully, the database changes are committed, and the lock from the initial modification step is released. Importantly, by only locking a single database resource (the copy's status), the transaction avoids the 'Hold and Wait' condition necessary for deadlocks, ensuring a smooth and deadlock-free process during copy rental transactions.

## Usage <a name="usage"></a>
To use this project, please follow the instructions below:
1. Install the required dependencies (Mysql, Xampp, PHP).
2. Clone or download the repository to your local machine under /Xampp/htdocs.
3. Using /db scripts to generate local database.
4. Make sure Apache and MySQL is running on Xampp.

Head to http://localhost/real4/index/index.php, use the root user to login(user name: az1, pw: 1234567).

## Web-based UI <a name="web-"></a>
### 1. Login/Signup
![image](/pictures/login.png)

### 2. Homepage
![image](/pictures/homepage.png)

### 3. Events
![image](/pictures/events.png)

### 4. Books
![image](/pictures/books.png)

### 5. Rental
![image](/pictures/rental_conf.png)

### 6. Study Rooms
![image](/pictures/studyRoom.png)

### 7. User Profile
![image](/pictures/user_profile.png)

### 8. My Rental
![image](/pictures/my_rental.png)

### 9. My Invoice
![image](/pictures/invoice.png)

### 10. Payment History
![image](/pictures/payment.png)













